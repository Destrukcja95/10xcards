---
/**
 * PublicNav - Pasek nawigacji z obsługą zalogowanych i niezalogowanych użytkowników
 * Dla zalogowanych: linki do Generuj, Moje fiszki, email i wyloguj
 * Dla niezalogowanych: link do logowania/rejestracji
 */

// Pobierz informację o zalogowanym użytkowniku
const {
  data: { user },
} = await Astro.locals.supabase.auth.getUser();

const isAuthenticated = !!user;
---

<nav role="navigation" aria-label="Główna nawigacja" class="container mx-auto px-4 sm:px-6 lg:px-8">
  <div class="flex h-16 items-center justify-between">
    <!-- Logo -->
    <a
      href="/"
      class="group flex items-center gap-2 text-xl font-bold tracking-tight text-foreground transition-colors hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 rounded-sm"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="size-7 text-primary transition-transform group-hover:rotate-12"
        aria-hidden="true"
      >
        <rect width="18" height="18" x="3" y="3" rx="2"></rect>
        <path d="M7 7h10"></path>
        <path d="M7 12h10"></path>
        <path d="M7 17h10"></path>
      </svg>
      <span>10x-cards</span>
    </a>

    <!-- Nawigacja -->
    {
      isAuthenticated ? (
        <div class="flex items-center gap-6">
          <a href="/generate" class="text-sm text-muted-foreground hover:text-foreground transition-colors">
            Generuj fiszki
          </a>
          <a href="/flashcards" class="text-sm text-muted-foreground hover:text-foreground transition-colors">
            Moje fiszki
          </a>
          <span class="text-sm text-muted-foreground">{user.email}</span>
          <form action="/api/auth/logout" method="POST">
            <button type="submit" class="text-sm text-muted-foreground hover:text-foreground transition-colors">
              Wyloguj się
            </button>
          </form>
        </div>
      ) : (
        <a
          href="/auth"
          class="inline-flex items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"
        >
          Zaloguj się
        </a>
      )
    }
  </div>
</nav>
